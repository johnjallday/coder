{
  "filename": "main.go",
  "scripts": [
    "package main\n\nimport (\n \"agent/coder/internal/grab\"\n \"agent/coder/internal/prompt\"\n \"agent/coder/internal/tree\"\n \"encoding/json\"\n \"fmt\"\n \"os\"\n \"sort\"\n)\n\ntype Command struct {\n Name        string              `json:\"name\"`\n Description string              `json:\"description\"`\n Handler     func(args []string) `json:\"-\"`\n}\n\nvar commands map[string]Command\n\nfunc init() {\n commands = map[string]Command{\n  \"tree\": {\n   Name:        \"tree\",\n   Description: \"Prints the directory tree structure\",\n   Handler: func(args []string) {\n    fmt.Println(\"Printing Directory Tree:\")\n    path := \".\"\n   if len(args) > 0 {\n       path = args[0]\n    }\n    if err := tree.PrintTree(path, \"\"); err != nil {\n     fmt.Println(\"Error printing tree:\", err)\n    }\n   },\n  },\n  \"tree-func\": {\n   Name:        \"tree-func\",\n   Description: \"Prints the directory tree structure with functions\",\n   Handler: func(args []string) {\n    fmt.Println(\"Printing Directory Tree with Functions:\")\n    path := \".\"\n    if len(args) > 0 {\n        path = args[0]\n    }\n    if err := tree.PrintTreeWithFunctions(path, \"\"); err != nil {\n     fmt.Println(\"Error printing tree with functions:\", err)\n    }\n   },\n  },\n  \"prompt\": {\n   Name:        \"prompt\",\n   Description: \"Prompts OpenAI with user input\",\n   Handler: func(args []string) {\n    fmt.Println(\"Enter your prompt:\")\n    prompt.PromptFromNeovim()\n   },\n  },\n  \"grab\": {\n   Name:        \"grab\",\n   Description: \"Grabs code files (file or folder auto-detected)\",\n   Handler: func(args []string) {\n    if len(args) < 1 {\n     grab.Grab(\"./\")\n     return\n    }\n    if err := grab.Grab(args[0]); err != nil {\n     fmt.Println(\"Error:\", err)\n    }\n   },\n  },\n  \"commands\": {\n   Name:        \"commands\",\n   Description: \"Displays available commands\",\n   Handler: func(args []string) {\n    printCommands()\n   },\n  },\n }\n}\n\nfunc printCommands() {\n fmt.Println(\"Usage: go run main.go <command> <arguments>\")\n fmt.Println(\"Available commands:\")\n\n keys := make([]string, 0, len(commands))\n for k := range commands {\n  keys = append(keys, k)\n }\n sort.Strings(keys)\n\n for _, k := range keys {\n  fmt.Printf(\"  %-10s - %s\\n\", k, commands[k].Description)\n }\n}\n\nfunc main() {\n // Special flag: if \"--list-commands\" is provided, output the commands as JSON.\n if len(os.Args) > 1 && os.Args[1] == \"--list-commands\" {\n  var cmds []Command\n  for _, cmd := range commands {\n   cmds = append(cmds, cmd)\n  }\n  sort.Slice(cmds, func(i, j int) bool {\n   return cmds[i].Name < cmds[j].Name\n  })\n  out, err := json.Marshal(cmds)\n  if err != nil {\n   fmt.Println(\"Error marshaling commands:\", err)\n   os.Exit(1)\n  }\n  fmt.Println(string(out))\n  return\n }\n\n if len(os.Args) < 2 {\n  printCommands()\n  os.Exit(1)\n }\n\n cmd, exists := commands[os.Args[1]]\n if !exists {\n  fmt.Println(\"Unknown command. Use 'commands' for available commands.\")\n  printCommands()\n  return\n }\n\n // Pass remaining args to the command handler\n cmd.Handler(os.Args[2:])\n}"
  ]
}